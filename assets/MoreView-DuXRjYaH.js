import{I as e,j as t,J as s,K as a,L as r}from"./index-tQUpmkV-.js";import{r as i}from"./react-vendor-D-3wKq8v.js";import{x as n,X as l,P as c,y as o,l as d,z as x,D as m,J as h,K as p}from"./ui-vendor-CrPKbo4G.js";import"./redux-vendor-CafaKUJ8.js";function u({onSessionSelected:x,onClose:m}){const[h]=i.useState(()=>e()),[p,u]=i.useState(0===h.length),[g,j]=i.useState(h.length>0?Math.max(...h.map(e=>e.sessionNumber))+1:1),[b,v]=i.useState((new Date).toISOString().split("T")[0]),[f,N]=i.useState("");return t.jsx("div",{className:"fixed inset-0 bg-black/95 backdrop-blur-sm z-[70] flex items-center justify-center p-4","data-testid":"session-picker",children:t.jsxs("div",{className:"card-parchment w-full max-w-md max-h-[85vh] flex flex-col shadow-2xl animate-scale-in",children:[t.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-white/10",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(n,{size:20,className:"text-white"}),t.jsx("h2",{className:"font-display text-lg text-parchment-light tracking-wider",children:"Sessions"})]}),m&&t.jsx("button",{onClick:m,className:"p-2 rounded-full bg-white/5 border border-white/20 text-white/60 hover:text-white hover:bg-white/10 transition-all",children:t.jsx(l,{size:18})})]}),t.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:p?t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"font-display text-sm text-parchment tracking-wider",children:"New Session"}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-muted block mb-1",children:"Session #"}),t.jsx("input",{type:"number",min:"1",max:"9999",value:g,onChange:e=>{const t=parseInt(e.target.value)||1;j(Math.max(1,Math.min(9999,t)))},className:"w-full bg-card-elevated border border-white/10 rounded px-3 py-2 text-parchment focus:outline-none focus:border-white/30"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-muted block mb-1",children:"Date"}),t.jsx("input",{type:"date",value:b,onChange:e=>v(e.target.value),className:"w-full bg-card-elevated border border-white/10 rounded px-3 py-2 text-parchment focus:outline-none focus:border-white/30"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-muted block mb-1",children:"Label (optional)"}),t.jsx("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"e.g. 'Battle at Ravenloft'",className:"w-full bg-card-elevated border border-white/10 rounded px-3 py-2 text-parchment placeholder:text-muted/50 focus:outline-none focus:border-white/30"})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[h.length>0&&t.jsx("button",{onClick:()=>u(!1),className:"btn-fantasy flex-1",children:"Back"}),t.jsxs("button",{onClick:()=>{try{const e=s(g,b,f||void 0);x(e)}catch(e){alert("Failed to create session: "+e)}},className:"btn-primary flex-1 flex items-center justify-center gap-2","data-testid":"start-session-btn",children:[t.jsx(c,{size:16}),"Start Session"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("button",{onClick:()=>u(!0),className:"w-full btn-primary flex items-center justify-center gap-2 py-3","data-testid":"new-session-btn",children:[t.jsx(c,{size:18}),"New Session"]}),h.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/10"}),t.jsx("span",{className:"text-xs text-muted",children:"or continue"}),t.jsx("div",{className:"h-px flex-1 bg-white/10"})]}),t.jsx("div",{className:"space-y-2",children:h.sort((e,t)=>new Date(t.lastModified).getTime()-new Date(e.lastModified).getTime()).map(e=>t.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-card-elevated/60 border border-white/10 cursor-pointer hover:border-white/30 transition-all group",onClick:()=>(e=>{const t=a(e);t&&x(t)})(e.id),children:[t.jsx("div",{className:"p-2 bg-card rounded-lg border border-white/10",children:t.jsx(o,{size:16,className:"text-parchment"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"text-sm font-display text-parchment-light",children:["Session ",e.sessionNumber,e.label&&t.jsxs("span",{className:"text-muted ml-2",children:["• ",e.label]})]}),t.jsxs("div",{className:"text-xs text-muted truncate",children:[new Date(e.date).toLocaleDateString()," • HP: ",e.characterData.hp.current,"/",e.characterData.hp.max]})]}),t.jsx("button",{onClick:t=>((e,t)=>{t.stopPropagation(),confirm("Delete this session? This cannot be undone.")&&(r(e),window.location.reload())})(e.id,t),className:"p-2 rounded-full opacity-0 group-hover:opacity-100 text-red-400 hover:text-red-300 hover:bg-red-500/10 transition-all",children:t.jsx(d,{size:14})})]},e.id))})]})]})})]})})}function g({onSelectView:e}){const[s,a]=i.useState(null);return t.jsxs("div",{className:"animate-fade-in space-y-4",children:[t.jsx("h2",{className:"font-kyoto uppercase text-lg text-parchment text-center mb-6",children:"Menu"}),t.jsxs("div",{className:"grid gap-3",children:[t.jsxs("button",{onClick:()=>e("patron"),className:"card-parchment p-4 flex items-center justify-between group active:scale-[0.98] transition-all border border-gold-dim/20 bg-gradient-to-br from-bg-dark/80 to-bg-void","data-testid":"more-menu-item-patron",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-3 bg-gold-mid/10 rounded-lg text-gold-mid group-hover:text-gold-bright group-hover:bg-gold-mid/20 transition-colors",children:t.jsx("span",{className:"font-display font-bold text-lg",children:"契"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("h3",{className:"font-display text-lg text-parchment group-hover:text-white transition-colors",children:"Pact Sworn"}),t.jsx("p",{className:"text-xs text-muted uppercase tracking-wide",children:"Consult Patron"})]})]}),t.jsx(x,{className:"text-muted group-hover:text-accent transition-colors"})]}),t.jsxs("button",{onClick:()=>e("inventory"),className:"card-parchment p-4 flex items-center justify-between group active:scale-[0.98] transition-all","data-testid":"more-menu-item-inventory",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-3 bg-white/5 rounded-lg text-parchment group-hover:text-accent group-hover:bg-white/10 transition-colors",children:t.jsx(m,{size:24})}),t.jsxs("div",{className:"text-left",children:[t.jsx("h3",{className:"font-display text-lg text-parchment group-hover:text-white transition-colors",children:"Inventory"}),t.jsx("p",{className:"text-xs text-muted uppercase tracking-wide",children:"Manage Items & Equipment"})]})]}),t.jsx(x,{className:"text-muted group-hover:text-accent transition-colors"})]}),t.jsxs("button",{onClick:()=>e("settings"),className:"card-parchment p-4 flex items-center justify-between group active:scale-[0.98] transition-all","data-testid":"more-menu-item-settings",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-3 bg-white/5 rounded-lg text-parchment group-hover:text-accent group-hover:bg-white/10 transition-colors",children:t.jsx(h,{size:24})}),t.jsxs("div",{className:"text-left",children:[t.jsx("h3",{className:"font-display text-lg text-parchment group-hover:text-white transition-colors",children:"Settings"}),t.jsx("p",{className:"text-xs text-muted uppercase tracking-wide",children:"Character Data & Rules"})]})]}),t.jsx(x,{className:"text-muted group-hover:text-accent transition-colors"})]})]}),t.jsxs("div",{className:"mt-8 border-t border-white/10 pt-6",children:[t.jsx("button",{onClick:()=>a("sessions"===s?null:"sessions"),className:"w-full card-parchment p-4 flex items-center justify-between group active:scale-[0.98] transition-all hover:border-white/20",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-3 bg-purple-500/10 rounded-lg text-purple-400",children:t.jsx(p,{size:24})}),t.jsxs("div",{className:"text-left flex-1",children:[t.jsx("h3",{className:"font-display text-lg text-parchment group-hover:text-white transition-colors",children:"Session Management"}),t.jsx("p",{className:"text-xs text-muted uppercase tracking-wide",children:"Admin"})]}),t.jsx(x,{className:"text-muted group-hover:text-white transition-colors "+("sessions"===s?"rotate-90":"")})]})}),"sessions"===s&&t.jsx("div",{className:"mt-4 bg-card border border-white/10 rounded-xl p-4 animate-scale-in",children:t.jsx(u,{onSessionSelected:e=>{a(null)},onClose:()=>a(null)})})]})]})}export{g as MoreView};
